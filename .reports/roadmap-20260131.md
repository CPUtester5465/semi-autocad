# Semi-AutoCAD Roadmap

## Current Status (v0.1.0)

### Completed ✅
- [x] Core CLI architecture (Click-based, SOLID principles)
- [x] Component registry with source adapters
- [x] Custom component library (16 drone parts)
- [x] cq_warehouse integration (fasteners, bearings)
- [x] Sub-project structure (projects/quadcopter-5inch)
- [x] Build system with variants and BOM generation
- [x] cq-editor integration with proper PYTHONPATH
- [x] Documentation (CLAUDE.md, README, cq-editor guide)

### Working Commands
```bash
./bin/dev view [file]           # cq-editor
./bin/dev build                 # Build root project
./bin/dev export <comp>         # Export component
./bin/dev render <stl>          # Render to PNG
./bin/dev test                  # Test imports
./bin/dev lib list|info|fasteners|bearings
./bin/dev search <query>
./bin/dev project info|list|build|view|neo4j
```

---

## Phase 1: Core Completion (Next)

### 1.1 Project Scaffolding
**Priority:** HIGH
**Effort:** 2-3 hours

Implement `./bin/dev project new <name>` to scaffold new sub-projects.

```bash
./bin/dev project new drone-7inch
# Creates:
# projects/drone-7inch/
# ├── partcad.yaml
# ├── config.py
# ├── frame.py
# ├── assembly.py
# ├── build.py
# └── __init__.py
```

**Tasks:**
- [ ] Create template files in `semicad/templates/`
- [ ] Add `project new` command to CLI
- [ ] Support `--template` option (basic, quadcopter, enclosure)
- [ ] Auto-update root partcad.yaml with new project

### 1.2 Export Module
**Priority:** MEDIUM
**Effort:** 2 hours

Populate `semicad/export/` with utilities currently in `scripts/export_views.py`.

```
semicad/export/
├── __init__.py
├── step.py      # STEP export with options
├── stl.py       # STL export (mesh quality settings)
├── render.py    # PNG rendering via trimesh
└── bom.py       # BOM generation utilities
```

**Tasks:**
- [ ] Move export_views.py logic to semicad/export/
- [ ] Add export quality options (mesh density, tolerance)
- [ ] Integrate with CLI export command
- [ ] Remove scripts/export_views.py after migration

### 1.3 Component Validation
**Priority:** MEDIUM
**Effort:** 1-2 hours

Add geometry validation to catch issues early.

```bash
./bin/dev lib validate motor_2207
# Checks:
# - Geometry is valid (no self-intersections)
# - Bounding box reasonable
# - Has expected features (holes, etc.)
```

**Tasks:**
- [ ] Add `validate` method to Component class
- [ ] Implement basic geometry checks (OCC validation)
- [ ] Add `lib validate` command
- [ ] Report warnings for common issues

---

## Phase 2: Enhanced Library (Near-term)

### 2.1 cq_electronics Source Adapter
**Priority:** MEDIUM
**Effort:** 2-3 hours

Add adapter for cq_electronics library (RPi boards, connectors).

```python
from semicad import get_registry
registry = get_registry()
rpi = registry.get("cq_electronics/RPi3b")
```

**Tasks:**
- [ ] Create `semicad/sources/electronics.py`
- [ ] Map cq_electronics components to our interface
- [ ] Handle different API patterns (cq_part, assembly)
- [ ] Register in default sources

### 2.2 PartCAD Integration
**Priority:** LOW
**Effort:** 3-4 hours

Deeper integration with PartCAD package manager.

```bash
./bin/dev partcad search "servo"
./bin/dev partcad install pub/electromechanics/towerpro
./bin/dev partcad render //pub/std/metric/bolt_m3
```

**Tasks:**
- [ ] Fix PartCAD CLI compatibility (or use Python API)
- [ ] Create `semicad/sources/partcad.py` adapter
- [ ] Add partcad commands to CLI
- [ ] Cache downloaded parts locally

### 2.3 Component Browser TUI
**Priority:** LOW
**Effort:** 4-5 hours

Interactive terminal UI for browsing components.

```bash
./bin/dev browse
# Opens rich TUI with:
# - Tree view of sources/categories
# - Component details panel
# - Quick export/view actions
```

**Tasks:**
- [ ] Add `textual` or `rich` dependency
- [ ] Create browse command with TUI
- [ ] Implement search/filter in TUI
- [ ] Add keyboard shortcuts

---

## Phase 3: Design Memory (Future)

### 3.1 Neo4j Design Decisions
**Priority:** LOW
**Effort:** 3-4 hours

Store and query design decisions in Neo4j.

```bash
./bin/dev memory add "Chose 220mm wheelbase for 5\" prop clearance"
./bin/dev memory search "wheelbase"
./bin/dev memory link motor_2207 frame --rel MOUNTS_ON
```

**Schema:**
```cypher
(:Decision {id, text, reasoning, timestamp})
(:Component {name, source, category})
(:Project {name, version})

(:Decision)-[:AFFECTS]->(:Component)
(:Project)-[:USES]->(:Component)
(:Component)-[:MOUNTS_ON]->(:Component)
```

**Tasks:**
- [ ] Define Neo4j schema for decisions
- [ ] Add `memory` command group to CLI
- [ ] Implement add/search/link subcommands
- [ ] Auto-record decisions during builds

### 3.2 Design Patterns Library
**Priority:** LOW
**Effort:** 4-5 hours

Extract and reuse common design patterns.

```bash
./bin/dev pattern save "fc-stack" --components fc,esc,standoffs
./bin/dev pattern apply "fc-stack" --to my-project
```

**Tasks:**
- [ ] Define pattern schema (components, positions, constraints)
- [ ] Store patterns in Neo4j
- [ ] Add pattern commands
- [ ] Include sample patterns (fc-stack, motor-mount, battery-tray)

---

## Phase 4: Advanced Features (Later)

### 4.1 Clearance Checker
Automated interference detection between components.

```bash
./bin/dev assembly check-clearances
# Prop clearance: 28.6mm ✓
# Battery-to-frame: 2.1mm ✓
# Motor-to-arm: INTERFERENCE ⚠
```

### 4.2 Drawing Generation
2D engineering drawings from 3D models.

```bash
./bin/dev drawing frame.step --views top,front,iso
# Generates frame_drawing.pdf with dimensions
```

### 4.3 Parametric Variants
Auto-generate size variants from base design.

```bash
./bin/dev variant generate --wheelbase 180,220,250
# Creates 3 variants with scaled geometry
```

### 4.4 Web Viewer
Simple web UI for viewing assemblies (three.js based).

```bash
./bin/dev serve
# Opens http://localhost:8080 with 3D viewer
```

---

## Technical Debt

### Code Quality
- [ ] Add type hints to all public functions
- [ ] Write unit tests for core modules
- [ ] Add docstrings (Google style)
- [ ] Set up pytest + coverage

### CI/CD
- [ ] GitHub Actions for tests
- [ ] Auto-publish to PyPI
- [ ] Version tagging

### Documentation
- [ ] API reference (sphinx)
- [ ] Tutorial: Creating a new project
- [ ] Tutorial: Adding custom components
- [ ] Video walkthrough

---

## Version Milestones

| Version | Features | Target |
|---------|----------|--------|
| v0.1.0 | Current state - MVP | Done |
| v0.2.0 | Project scaffolding, export module | +1 week |
| v0.3.0 | cq_electronics, component validation | +2 weeks |
| v0.4.0 | Design memory (Neo4j) | +1 month |
| v1.0.0 | Stable API, full documentation | +2 months |

---

## Quick Wins (< 1 hour each)

1. **Add `--verbose` flag** to all commands for debug output
2. **Add `project clean`** to remove output/ directories
3. **Add `lib export-all`** to export entire library to STEP
4. **Add `--json` output** for scripting/integration
5. **Add shell completion** (Click supports this)
6. **Add `version` command** showing all package versions

---

## Dependencies to Watch

| Package | Current | Notes |
|---------|---------|-------|
| cadquery | 2.5.2 | Stable |
| cq-editor | latest | Watch for Qt6 migration |
| cq_warehouse | 0.8.0 | Stable, good API |
| cq_electronics | 0.2.0 | Limited, may need contributions |
| partcad | 0.7.135 | CLI broken, use Python API |
| click | 8.x | Stable |

---

## Contributing

To add a new feature:

1. Create branch: `git checkout -b feature/my-feature`
2. Implement with tests
3. Update CLAUDE.md if architecture changes
4. Update this roadmap
5. Submit PR

For new component sources:
1. Create `semicad/sources/mylib.py`
2. Implement `ComponentSource` interface
3. Register in `semicad/core/registry.py`
4. Add tests
